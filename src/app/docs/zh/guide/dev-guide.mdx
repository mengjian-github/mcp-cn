> ğŸš€ MCP Server æ˜¯ä¸€ä¸ªæ ‡å‡†åŒ–çš„æœåŠ¡ï¼Œå®ƒå…è®¸ AI æ¨¡å‹ä¸å„ç§æ•°æ®æºå’Œå·¥å…·è¿›è¡Œäº¤äº’ã€‚æœ¬æ–‡å°†ä¸ºä½ ä»‹ç»å¦‚ä½•å¼€å‘å±äºè‡ªå·±çš„ MCP Serverã€‚

## ğŸ“‹ å¼€å‘æ–¹å¼æ¦‚è¿°

MCP Server æ”¯æŒä»¥ä¸‹å¼€å‘æ–¹å¼ï¼š

- ğŸ“¦ NPM åŒ…ï¼šé€šè¿‡ npm åŒ…æ–¹å¼å¼€å‘å’Œåˆ†å‘
- ğŸŒ ç‹¬ç«‹æœåŠ¡ï¼šä½œä¸ºç‹¬ç«‹çš„ SSE / WebSocket æœåŠ¡è¿è¡Œ
- ğŸ”Œ å†…ç½®é›†æˆï¼šç›´æ¥é›†æˆåˆ°ç°æœ‰åº”ç”¨ä¸­

æœ¬æ–‡ä¸»è¦ä»‹ç»æœ€å¸¸ç”¨çš„ NPM åŒ…å¼€å‘æ–¹å¼ã€‚

## 1. ğŸ¯ åˆ›å»ºé¡¹ç›®

### 1.1 åˆ›å»ºç›®å½•

é¦–å…ˆåˆ›å»ºä¸€ä¸ªæ–°çš„ npm é¡¹ç›®ï¼š

```bash
mkdir my-mcp-server
cd my-mcp-server
npm init -y
```

### 1.2 æ›´æ–° package.json

æ›´æ–° `package.json` æ–‡ä»¶ä¸­çš„ä¿¡æ¯ï¼Œæ·»åŠ å¿…è¦çš„ä¾èµ–ï¼Œå¦‚@modelcontextprotocol/sdkã€zodã€typescriptã€ts-nodeç­‰
```json
{
  "name": "@mcp_hub/my-mcp-server",
  "version": "1.0.0",
  "type": "module",
  "main": "dist/index.js",
  "type": "module",
  "bin": {
    "my-mcp-server": "dist/index.js"
  },
  "scripts": {
    "build": "tsc",
    "start": "node dist/index.js",
    "dev": "ts-node src/index.ts",
    "prepare": "npm run build"
  },
  "dependencies": {
    "@modelcontextprotocol/sdk": "^1.0.3",
    "zod": "^3.22.4"
  },
  "devDependencies": {
    "@types/node": "^20.11.28",
    "ts-node": "^10.9.2",
    "typescript": "^5.4.2"
  }
}
```

### 1.3 é…ç½® TypeScript

åˆ›å»º `tsconfig.json`ï¼Œæ·»åŠ é…ç½®

```json
{
  "compilerOptions": {
    "target": "ES2020",
    "module": "ESNext",
    "moduleResolution": "node",
    "esModuleInterop": true,
    "strict": true,
    "skipLibCheck": true,
    "forceConsistentCasingInFileNames": true,
    "outDir": "./dist",
    "rootDir": "./src"
  },
  "include": ["src/**/*"],
  "exclude": ["node_modules", "dist"]
} 
```

### 1.4 å®‰è£…ä¾èµ–
åœ¨æ ¹ç›®å½•æ‰§è¡Œ `npm install` å®‰è£…ä¾èµ–

```bash
npm install
```

## 2. ğŸ’» ç¼–å†™ä»£ç 

### 2.1 åˆ›å»ºåŸºç¡€æœåŠ¡å™¨

åœ¨ `src/index.ts` ä¸­åˆ›å»ºåŸºç¡€ä»£ç ï¼š

```typescript
import { McpServer } from '@modelcontextprotocol/sdk/server/mcp.js';
import { StdioServerTransport } from '@modelcontextprotocol/sdk/server/stdio.js';

// åˆ›å»º MCP æœåŠ¡å™¨å®ä¾‹
const server = new McpServer({
  name: "my-mcp-server",
  version: "1.0.0"
});

// å¯åŠ¨æœåŠ¡å™¨
async function main() {
  try {
    const transport = new StdioServerTransport();
    await server.connect(transport);
    console.error('MCP æœåŠ¡å™¨å·²å¯åŠ¨');
  } catch (error) {
    console.error('MCP æœåŠ¡å™¨å¯åŠ¨å¤±è´¥:', error);
    process.exit(1);
  }
}

main();
```

### 2.2 å¼€å‘ Tools

MCP Server å¯ä»¥æ³¨å†Œå„ç§ Toolsï¼ˆæ‰§è¡ŒæŸä¸ªé€»è¾‘çš„å‡½æ•°å·¥å…·ï¼‰ä¾› AI æ¨¡å‹ä½¿ç”¨ï¼š

```typescript
import { z } from "zod";

// æ³¨å†Œä¸€ä¸ªç®€å•çš„åŠ æ³•å·¥å…·
server.tool(
  "add",
  { a: z.number(), b: z.number() },
  async ({ a, b }) => ({
    content: [{ type: "text", text: String(a + b) }]
  })
);
```

## 3. ğŸš€ å‘å¸ƒå’Œä½¿ç”¨

### 3.1 å‘å¸ƒåˆ° NPM

```bash
npm publish
```

### 3.2 åœ¨å®¢æˆ·ç«¯ä¸­ä½¿ç”¨

ä½ å¯ä»¥å¤åˆ¶ä»¥ä¸‹é…ç½®åˆ° AI Client ä¸­æµ‹è¯• MCP Serverã€‚æ›´å¥½çš„é€‰æ‹©æ˜¯åœ¨ MCP Hub ä¸Š <a href="/docs/register" target="_blank">æ³¨å†Œä½ çš„ MCP Server</a>ã€‚

```json
{
  "mcpServers": {
    "my-server": {
      "command": "npx",
      "args": ["-y", "@your-scope/my-mcp-server"],
      "env": {
        "API_KEY": "your-api-key"
      }
    }
  }
}
```

## 4. âœ… è°ƒè¯•å’Œæµ‹è¯•

### 4.1 ä½¿ç”¨ Inspector

MCP Inspector æ˜¯ä¸€ä¸ªç”¨äºæµ‹è¯•å’Œè°ƒè¯•çš„å·¥å…·ï¼Œè¿è¡Œä»¥ä¸‹æŒ‡ä»¤è°ƒè¯•ä½ çš„ MCP Serverã€‚

```bash
npx @modelcontextprotocol/inspector npx @your-scope/my-mcp-server
```

### 4.2 å•å…ƒæµ‹è¯•

å¯ä½¿ç”¨ Jest è¿›è¡Œå•å…ƒæµ‹è¯•ï¼š

```typescript
import { McpServer } from "@modelcontextprotocol/sdk/server/mcp.js";

describe("MCP Server", () => {
  let server: McpServer;

  beforeEach(() => {
    server = new McpServer({
      name: "test-server",
      version: "1.0.0"
    });
  });

  test("add tool works correctly", async () => {
    // æµ‹è¯•ä»£ç 
  });
});
```

## ğŸ“š æ›´å¤šèµ„æº

- ğŸ“– <a href="https://modelcontextprotocol.io/quickstart/server" target="_blank">MCP Server å¼€å‘æŒ‡å—</a>
- ğŸ“˜ <a href="https://github.com/modelcontextprotocol/typescript-sdk" target="_blank">MCP SDK æ–‡æ¡£</a>
- ğŸ” <a href="https://modelcontextprotocol.io/docs/tools/inspector" target="_blank">MCP Serverè°ƒè¯•å·¥å…·</a>
- ğŸŒŸ <a href="https://modelcontextprotocol.io/examples" target="_blank">MCP Server ç¤ºä¾‹é¡¹ç›®</a>
- ğŸ’¬ <a href="https://github.com/orgs/modelcontextprotocol/discussions" target="_blank">ç¤¾åŒºè®¨è®º</a>